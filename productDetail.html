<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Detail</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <h1>Product Detail</h1>
</header>

<button onclick="window.location.href='index.html'">Back to Home</button>

<div id="productDetailContainer"></div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
  var firebaseConfig = {
    apiKey: "AIzaSyBTSEX-KMCddwLaKNCSEvEI0OQr58uayyg",
    authDomain: "we0023-59d22.firebaseapp.com",
    projectId: "we0023-59d22",
    storageBucket: "we0023-59d22.firebasestorage.app",
    messagingSenderId: "443902240610",
    appId: "1:443902240610:web:a649d92142e78c51b3ee3b"
  };
  if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
  var db = firebase.firestore();

  const currentUser = prompt("Enter your seller name for delete permission:");
  const id = localStorage.getItem("selectedItemId");
  const container = document.getElementById("productDetailContainer");

  if(!id) container.innerHTML = "<p>No product selected.</p>";
  else {
    db.collection("products").doc(id).get().then(doc => {
      if(!doc.exists) { container.innerHTML = "<p>Product not found.</p>"; return; }

      const item = doc.data();
      container.innerHTML = `
        <h2>${item.productName}</h2>
        <img src="${item.imageUrl}">
        <p><strong>Seller:</strong> ${item.sellerName}</p>
        <p><strong>Blok:</strong> ${item.blok}</p>
        <p><strong>Phone:</strong> ${item.phone}</p>
        <p><strong>Product Category:</strong> ${item.productCategory}</p>
        <p><strong>Service Category:</strong> ${item.serviceCategory}</p>
        <p><strong>Price:</strong> RM${item.price}</p>
        <p><strong>Description:</strong> ${item.description}</p>
      `;

      if(item.sellerName === currentUser){
        const deleteBtn = document.createElement("button");
        deleteBtn.innerText = "Delete Item";
        deleteBtn.onclick = () => {
          if(confirm("Delete this item?")){
            db.collection("products").doc(id).delete().then(()=> {
              alert("Item deleted.");
              window.location.href = "index.html";
            });
          }
        };
        container.appendChild(deleteBtn);
      }
    });
  }
</script>

</body>
</html>

